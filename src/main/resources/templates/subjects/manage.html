<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/layout :: head"></head>
<body>
<header th:replace="fragments/layout :: header"></header>

<main class="container">
    <h2>Manage Your Subjects</h2>
    
    <!-- Success/Error Messages -->
    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>
    
    <p>Select the subjects you study or can tutor. This helps the matching algorithm find suitable partners for you.</p>
    
    <!-- Subject Selection Form -->
    <form th:action="@{/subjects/update}" method="post">
        <div class="subjects-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 24px;">
            <div th:each="subject : ${allSubjects}" class="subject-item" 
                 style="background: white; padding: 12px; border: 1px solid #ddd; border-radius: 8px;">
                <label style="display: flex; align-items: center; cursor: pointer; margin: 0;">
                    <input type="checkbox" 
                           name="subjectIds" 
                           th:value="${subject.id}"
                           th:checked="${userSubjectIds.contains(subject.id)}"
                           style="margin-right: 8px; width: 16px; height: 16px;" />
                    <span th:text="${subject.name}" style="font-weight: 500;">Mathematics</span>
                </label>
            </div>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn">Update My Subjects</button>
            <a th:href="@{/dashboard}" class="btn" style="background: #6c757d; margin-left: 8px;">Cancel</a>
        </div>
    </form>
    
    <!-- Current Subjects Summary -->
    <div class="current-subjects" style="margin-top: 32px;">
        <h3>Your Current Subjects</h3>
        
        <div th:if="${#lists.isEmpty(user.subjects)}">
            <p class="alert alert-warning">No subjects selected. Please choose subjects above to enable tutoring requests.</p>
        </div>
        
        <div th:if="${!#lists.isEmpty(user.subjects)}">
            <p>You have selected <strong th:text="${#lists.size(user.subjects)}">3</strong> subjects:</p>
            
            <div class="selected-subjects" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px;">
                <span th:each="subject : ${user.subjects}" 
                      class="badge subject-badge"
                      th:text="${subject.name}">
                    Mathematics
                </span>
            </div>
        </div>
    </div>
    
    <!-- Navigation -->
    <div class="navigation-section" style="margin-top: 24px;">
        <a th:href="@{/dashboard}" class="btn">‚Üê Back to Dashboard</a>
        <a th:href="@{/profile}" class="btn">Update Profile</a>
        <a th:href="@{/availability}" class="btn">Set Availability</a>
    </div>
</main>

<footer th:replace="fragments/layout :: footer"></footer>

<style>
.subject-item:hover {
    background: #f8f9fa !important;
    border-color: #8b0000 !important;
}

.subject-badge {
    background: #8b0000;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
}
</style>

</body>
</html>